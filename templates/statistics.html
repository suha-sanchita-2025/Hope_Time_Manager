{% extends "base.html" %}
{% block content %}

<script>
    if (localStorage.getItem('theme') === 'dark') {
        document.documentElement.classList.add('dark');
    }
</script>
<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = { darkMode: 'class' };
</script>

<body class="bg-purple-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 p-4 transition-colors duration-300">

<button id="darkToggle"
        class="bg-white text-purple-700 border border-purple-700 px-4 py-2 rounded shadow hover:bg-purple-100 dark:bg-gray-800 dark:text-gray-100 dark:border-gray-300">
    Toggle Dark Mode
</button>

<div class="w-full max-w-8xl mx-auto bg-white rounded-lg shadow p-6 mb-8">
    <h2 class="text-xl font-bold mb-4 text-center">Statistics</h2>
    <div class="flex flex-row gap-16 justify-center items-center">
        <div class="w-96 h-96 flex items-center justify-center bg-purple-50 rounded shadow">
            <div>
                <h3 class="text-center font-semibold mb-2">Tasks by Category</h3>
                <canvas id="categoryPieChart" width="350" height="350"></canvas>
            </div>
        </div>
        <div class="w-96 h-96 flex items-center justify-center bg-purple-50 rounded shadow">
            <div>
                <h3 class="text-center font-semibold mb-2">Completed vs Incomplete Tasks</h3>
                <canvas id="completionDonutChart" width="350" height="350"></canvas>
            </div>
        </div>
        <div class="w-96 h-96 flex items-center justify-center bg-purple-50 rounded shadow">
            <div>
                <h3 class="text-center font-semibold mb-2">Tasks per Category (Completed/Incomplete)</h3>
                <canvas id="categoryBarChart" width="350" height="350"></canvas>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById('darkToggle').addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        const isDark = document.documentElement.classList.contains('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    const categories = {{ categories|tojson }};
    const tasksByCategory = {{ tasks_by_category|tojson }};
    const completed = {{ completed }};
    const incomplete = {{ incomplete }};
    const barCompleted = {{ bar_completed|tojson }};
    const barIncomplete = {{ bar_incomplete|tojson }};
</script>
<script src="../static/statistics.js"></script>
{% endblock %}